<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reporting Inversionistas</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div id="login-screen" class="login-screen">
        <div class="login-card">
            <div class="login-logo">
                <svg width="48" height="48" viewBox="0 0 48 48" fill="none">
                    <rect width="48" height="48" rx="12" fill="#1a365d"/>
                    <path d="M14 34V18L24 12L34 18V34" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M20 34V26H28V34" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M14 18H34" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
                </svg>
            </div>
            <h1 class="login-title">Reporting Inversionistas</h1>
            <p class="login-subtitle">Ingresa la contraseña del proyecto para acceder</p>
            <form id="login-form">
                <div class="input-group">
                    <label for="password-input">Contraseña del proyecto</label>
                    <div class="input-wrapper">
                        <input type="password" id="password-input" placeholder="Ingresa la contraseña" autocomplete="off">
                        <button type="button" id="toggle-password" class="toggle-password" aria-label="Mostrar contraseña">
                            <svg class="eye-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                            <svg class="eye-off-icon hidden" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                        </button>
                    </div>
                </div>
                <div id="login-error" class="login-error hidden">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>
                    Contraseña incorrecta. Intenta de nuevo.
                </div>
                <button type="submit" id="login-btn" class="btn-primary">
                    Acceder al proyecto
                </button>
            </form>
        </div>
    </div>

    <!-- DASHBOARD -->
    <div id="dashboard" class="dashboard hidden">
        <!-- Header -->
        <header class="header">
            <div class="header-inner">
                <div class="header-left">
                    <svg class="header-logo" width="36" height="36" viewBox="0 0 48 48" fill="none">
                        <rect width="48" height="48" rx="12" fill="#1a365d"/>
                        <path d="M14 34V18L24 12L34 18V34" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M20 34V26H28V34" stroke="white" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M14 18H34" stroke="white" stroke-width="2.5" stroke-linecap="round"/>
                    </svg>
                    <div>
                        <h1 id="project-name" class="header-title">Casa Arboledas</h1>
                        <p id="last-updated" class="header-date">Cargando datos...</p>
                    </div>
                </div>
                <div class="header-right">
                    <button id="refresh-btn" class="btn-icon" title="Actualizar datos">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
                    </button>
                    <button id="print-btn" class="btn-icon" title="Imprimir reporte">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 6 2 18 2 18 9"/><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/><rect x="6" y="14" width="12" height="8"/></svg>
                    </button>
                    <button id="logout-btn" class="btn-logout" title="Cerrar sesión">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
                        <span>Salir</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="nav">
            <div class="nav-inner">
                <button class="nav-btn active" data-section="resumen">Resumen</button>
                <button class="nav-btn" data-section="presupuesto">Presupuesto</button>
                <button class="nav-btn" data-section="financieros">Financieros</button>
                <button class="nav-btn" data-section="casas">Casas</button>
                <button class="nav-btn" data-section="ventas">Ventas</button>
                <button class="nav-btn" data-section="galeria">Galería</button>
                <button class="nav-btn" data-section="gastos">Gastos</button>
            </div>
        </nav>

        <!-- Loading State -->
        <div id="loading-state" class="loading-state">
            <div class="spinner"></div>
            <p>Cargando datos del proyecto...</p>
        </div>

        <!-- Error State -->
        <div id="error-state" class="error-state hidden">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#e53e3e" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
            <h3>Error al cargar los datos</h3>
            <p id="error-message">No se pudieron obtener los datos del proyecto. Verifica tu conexión a internet e intenta de nuevo.</p>
            <button onclick="App.loadData()" class="btn-primary" style="margin-top: 1rem;">Reintentar</button>
        </div>

        <!-- Main Content -->
        <main id="main-content" class="main-content hidden">
            <!-- SECTION: Resumen Ejecutivo -->
            <section id="section-resumen" class="section">
                <div class="summary-cards">
                    <div class="summary-card">
                        <div class="summary-icon blue">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="18" rx="2"/><line x1="2" y1="9" x2="22" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
                        </div>
                        <div class="summary-info">
                            <span class="summary-label">Inversión Total</span>
                            <span id="total-investment" class="summary-value">--</span>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon orange">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1v22M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
                        </div>
                        <div class="summary-info">
                            <span class="summary-label">Gastado a la Fecha</span>
                            <span id="total-spent" class="summary-value">--</span>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon green">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                        </div>
                        <div class="summary-info">
                            <span class="summary-label">Avance General</span>
                            <span id="general-progress" class="summary-value">--</span>
                        </div>
                    </div>
                    <div class="summary-card">
                        <div class="summary-icon purple">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
                        </div>
                        <div class="summary-info">
                            <span class="summary-label">ROI Proyectado</span>
                            <span id="expected-roi" class="summary-value">--</span>
                        </div>
                    </div>
                </div>

                <!-- Quick Overview -->
                <div class="grid-2">
                    <div class="card">
                        <h3 class="card-title">Avance por Categoría</h3>
                        <div id="category-progress-summary" class="progress-list">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Distribución del Capital</h3>
                        <div id="capital-distribution" class="capital-dist">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECTION: Presupuesto vs Ejecutado -->
            <section id="section-presupuesto" class="section hidden">
                <h2 class="section-title">Presupuesto vs Ejecutado</h2>

                <!-- Hard Costs -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span class="category-dot hard"></span>
                            Hard Costs (Construcción)
                        </h3>
                        <div id="hard-cost-badge" class="badge">--</div>
                    </div>
                    <div id="hard-cost-progress" class="budget-progress">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <!-- Soft Costs -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span class="category-dot soft"></span>
                            Soft Costs
                        </h3>
                        <div id="soft-cost-badge" class="badge">--</div>
                    </div>
                    <div id="soft-cost-progress" class="budget-progress">
                        <!-- Filled by JS -->
                    </div>
                    <div id="soft-cost-breakdown" class="subcategory-breakdown">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <!-- Terreno -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">
                            <span class="category-dot terreno"></span>
                            Terreno
                        </h3>
                        <div id="terreno-badge" class="badge">--</div>
                    </div>
                    <div id="terreno-progress" class="budget-progress">
                        <!-- Filled by JS -->
                    </div>
                    <div id="terreno-breakdown" class="subcategory-breakdown">
                        <!-- Filled by JS -->
                    </div>
                </div>

                <!-- Totals -->
                <div class="card card-highlight">
                    <div class="card-header">
                        <h3 class="card-title">Resumen Total</h3>
                    </div>
                    <div id="total-budget-summary" class="budget-total-summary">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </section>

            <!-- SECTION: Indicadores Financieros -->
            <section id="section-financieros" class="section hidden">
                <h2 class="section-title">Indicadores Financieros</h2>
                <div class="grid-2">
                    <div class="card">
                        <h3 class="card-title">Indicadores del Proyecto</h3>
                        <div id="project-indicators" class="indicators-list">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title">Indicadores de Capital</h3>
                        <div id="capital-indicators" class="indicators-list">
                            <!-- Filled by JS -->
                        </div>
                    </div>
                </div>
                <div class="card">
                    <h3 class="card-title">Inversionistas</h3>
                    <div id="investors-list" class="investors-grid">
                        <!-- Filled by JS -->
                    </div>
                </div>
            </section>

            <!-- SECTION: Información de Casas -->
            <section id="section-casas" class="section hidden">
                <h2 class="section-title">Información de las Casas</h2>
                <div id="houses-grid" class="grid-2">
                    <!-- Filled by JS -->
                </div>
            </section>

            <!-- SECTION: Estado de Ventas -->
            <section id="section-ventas" class="section hidden">
                <h2 class="section-title">Estado de Ventas</h2>
                <div class="grid-2" id="sales-grid">
                    <!-- Filled by JS -->
                </div>
            </section>

            <!-- SECTION: Galería de Fotos -->
            <section id="section-galeria" class="section hidden">
                <h2 class="section-title">Galería de Avance de Obra</h2>
                <div id="gallery-container" class="gallery-container">
                    <div id="gallery-loading" class="gallery-loading">
                        <div class="spinner"></div>
                        <p>Cargando fotos del proyecto...</p>
                    </div>
                    <div id="gallery-grid" class="gallery-grid hidden">
                        <!-- Filled by JS -->
                    </div>
                    <div id="gallery-empty" class="gallery-empty hidden">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#a0aec0" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                        <p>No se encontraron fotos del proyecto.</p>
                    </div>
                </div>
            </section>

            <!-- SECTION: Historial de Gastos -->
            <section id="section-gastos" class="section hidden">
                <h2 class="section-title">Historial de Gastos</h2>
                <div class="card">
                    <!-- Filters -->
                    <div class="filters">
                        <div class="filter-group">
                            <label>Categoría</label>
                            <select id="filter-category">
                                <option value="all">Todas</option>
                                <option value="Hard Cost">Hard Cost</option>
                                <option value="Soft Cost">Soft Cost</option>
                                <option value="Terreno">Terreno</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Subcategoría</label>
                            <select id="filter-subcategory">
                                <option value="all">Todas</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <label>Desde</label>
                            <input type="date" id="filter-date-from">
                        </div>
                        <div class="filter-group">
                            <label>Hasta</label>
                            <input type="date" id="filter-date-to">
                        </div>
                        <button id="clear-filters" class="btn-secondary">Limpiar filtros</button>
                    </div>

                    <!-- Table -->
                    <div class="table-wrapper">
                        <table id="expenses-table" class="expenses-table">
                            <thead>
                                <tr>
                                    <th>Fecha</th>
                                    <th>Categoría</th>
                                    <th>Subcategoría</th>
                                    <th class="text-right">Monto</th>
                                </tr>
                            </thead>
                            <tbody id="expenses-tbody">
                                <!-- Filled by JS -->
                            </tbody>
                            <tfoot>
                                <tr>
                                    <td colspan="3"><strong>Total filtrado</strong></td>
                                    <td id="expenses-total" class="text-right"><strong>--</strong></td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                    <div id="no-expenses" class="no-data hidden">
                        No se encontraron gastos con los filtros seleccionados.
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="lightbox hidden">
        <button class="lightbox-close" onclick="App.closeLightbox()">&times;</button>
        <button class="lightbox-prev" onclick="App.prevPhoto()">&#10094;</button>
        <button class="lightbox-next" onclick="App.nextPhoto()">&#10095;</button>
        <img id="lightbox-img" src="" alt="Foto de avance">
        <div id="lightbox-caption" class="lightbox-caption"></div>
    </div>

    <script src="data.js"></script>
    <script src="auth.js"></script>
    <script src="app.js"></script>
</body>
</html>
